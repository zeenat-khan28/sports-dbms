================================================================================
           FORMS DESIGN, SECURITY & VALIDATION DOCUMENTATION
                  RVCE SPORTS MANAGEMENT SYSTEM
================================================================================

1. INTRODUCTION
---------------
This document provides comprehensive details on all forms in the RVCE Sports
Management System, including field specifications, validation rules, security
measures, and error handling strategies.

================================================================================
2. FORM INVENTORY
================================================================================

STUDENT PORTAL FORMS:
1. Student Registration Form (StudentRegisterPage.jsx)
2. Event Participation Request Form (StudentEventsPage.jsx)

ADMIN PORTAL FORMS:
3. Admin Login Form (LoginPage.jsx)
4. Event Creation Form (AdminEventsPage.jsx)
5. Attendance Marking Form (EventAttendancePage.jsx)
6. Bulk Email Form (AdminEmailPage.jsx)
7. Approval Action Form (PendingPage.jsx)

================================================================================
3. DETAILED FORM SPECIFICATIONS
================================================================================

--------------------------------------------------------------------------------
FORM 1: STUDENT REGISTRATION FORM
--------------------------------------------------------------------------------

PURPOSE: Collect comprehensive student information for sports participation

LOCATION: /student/register (StudentRegisterPage.jsx)
ACCESS: Authenticated students only (@rvce.edu.in Google account)
METHOD: POST /api/submissions

FIELDS AND SPECIFICATIONS:

SECTION A: PERSONAL INFORMATION
--------------------------------
1. Student Name
   - Label: "Name of the Student"
   - Type: Text input
   - Required: Yes
   - Min Length: 3 characters
   - Max Length: 255 characters
   - Validation: Alphabets and spaces only
   - Pattern: ^[A-Za-z\s]+$
   - Error Messages:
     * Empty: "Student name is required"
     * Too short: "Name must be at least 3 characters"
     * Invalid characters: "Name can only contain letters and spaces"

2. University Seat Number (USN)
   - Label: "USN (University Seat Number)"
   - Type: Text input (uppercase transformation)
   - Required: Yes
   - Format: 1RVYYBBXXX (Y=year, B=branch, X=roll)
   - Pattern: ^1RV[0-9]{2}[A-Z]{2}[0-9]{3}$
   - Example: 1RV21CS001
   - Validation:
     * Format check (client + server)
     * Uniqueness check (server-side against MongoDB + PostgreSQL)
   - Error Messages:
     * Invalid format: "USN must be in format 1RVYYBBXXX (e.g., 1RV21CS001)"
     * Duplicate: "This USN is already registered"

3. Branch/Department
   - Label: "Branch"
   - Type: Dropdown select
   - Required: Yes
   - Options:
     * CSE - Computer Science and Engineering
     * ISE - Information Science and Engineering
     * ECE - Electronics and Communication Engineering
     * EEE - Electrical and Electronics Engineering
     * MECH - Mechanical Engineering
     * CIVIL - Civil Engineering
     * CHEM - Chemical Engineering
     * BT - Biotechnology
     * AI&ML - Artificial Intelligence and Machine Learning
     * CSD - Computer Science and Design
   - Default: None (placeholder: "Select Branch")
   - Error Message: "Please select your branch"

4. Current Semester
   - Label: "Current Semester"
   - Type: Number input / Dropdown
   - Required: Yes
   - Range: 1-8
   - Validation: Integer between 1 and 8
   - Error Messages:
     * Out of range: "Semester must be between 1 and 8"
     * Non-integer: "Please enter a valid semester number"

5. Date of Birth
   - Label: "Date of Birth"
   - Type: Date picker
   - Required: Yes
   - Format: YYYY-MM-DD or DD/MM/YYYY (converted to ISO)
   - Validation:
     * Must be past date
     * Age >= 17 years (minimum college age)
     * Age <= 30 years (reasonable upper limit)
   - Error Messages:
     * Future date: "Date of birth cannot be in the future"
     * Too young: "You must be at least 17 years old"
     * Invalid date: "Please enter a valid date"

6. Blood Group
   - Label: "Blood Group"
   - Type: Dropdown select
   - Required: Yes
   - Options: A+, A-, B+, B-, AB+, AB-, O+, O-
   - Default: None
   - Error Message: "Please select your blood group"

SECTION B: CONTACT INFORMATION
-------------------------------
7. Phone/Cell Number
   - Label: "Phone Number"
   - Type: Tel input
   - Required: Yes
   - Pattern: ^[0-9]{10}$
   - Validation: Exactly 10 digits (Indian mobile)
   - Placeholder: "9876543210"
   - Error Messages:
     * Invalid format: "Phone must be 10 digits"
     * Non-numeric: "Phone can only contain numbers"

8. Contact Address
   - Label: "Contact Address"
   - Type: Textarea
   - Required: Yes
   - Min Length: 10 characters
   - Max Length: 500 characters
   - Rows: 3
   - Error Messages:
     * Empty: "Address is required"
     * Too short: "Address must be at least 10 characters"

9. Father's/Guardian's Name
   - Label: "S/o, D/o (Parent Name)"
   - Type: Text input
   - Required: Yes
   - Min Length: 3 characters
   - Max Length: 255 characters
   - Pattern: ^[A-Za-z\s\.]+$
   - Error Message: "Parent name is required"

10. Mother's Name
    - Label: "Mother's Name"
    - Type: Text input
    - Required: Yes
    - Min Length: 3 characters
    - Max Length: 255 characters
    - Pattern: ^[A-Za-z\s\.]+$
    - Error Message: "Mother's name is required"

SECTION C: ACADEMIC INFORMATION
--------------------------------
11. Course Name
    - Label: "Name of the Course"
    - Type: Text input
    - Required: Yes
    - Default: "B.E." (can be edited)
    - Max Length: 100 characters
    - Error Message: "Course name is required"

12. Passing Year of 10+2/PUC/Diploma
    - Label: "Passing Year of PUC"
    - Type: Number input
    - Required: Yes
    - Range: 2000 - current_year
    - Validation: 4-digit year
    - Error Messages:
     * Invalid year: "Please enter a valid year (YYYY)"
     * Future year: "Passing year cannot be in the future"

13. Date of First Admission to Present Course
    - Label: "Date of First Admission to Course"
    - Type: Date picker
    - Required: Yes
    - Validation: Must be past date
    - Error Message: "Please enter valid admission date"

14. Date of First Admission to Present Class/Semester
    - Label: "Date of First Admission to Current Sem"
    - Type: Date picker
    - Required: Yes
    - Validation: Must be >= course admission date
    - Error Message: "Class admission must be after course admission"

SECTION D: SPORTS INFORMATION
------------------------------
15. Game/Sport/Competition
    - Label: "Game/Sport/Competition"
    - Type: Text input
    - Required: Yes
    - Min Length: 3 characters
    - Max Length: 255 characters
    - Examples: "Cricket", "Football", "Athletics - 100m Sprint"
    - Error Message: "Please specify the sport/game"

16. Organizing Institution
    - Label: "Organizing Institution"
    - Type: Text input
    - Required: Yes
    - Default: "RVCE"
    - Max Length: 255 characters
    - Error Message: "Organizing institution is required"

17. Date of Activity
    - Label: "Date of Activity"
    - Type: Date picker
    - Required: Yes
    - Validation: Any date (past, present, or future)
    - Error Message: "Activity date is required"

18. Year of Activity
    - Label: "Year"
    - Type: Number input
    - Required: No
    - Default: Current year
    - Range: 2020 - current_year + 1

19. Previous Game Participated
    - Label: "Previous Game (if any)"
    - Type: Text input
    - Required: No
    - Max Length: 500 characters

20. Previous Years of Participation
    - Label: "Previous Years"
    - Type: Text input
    - Required: No
    - Max Length: 100 characters
    - Example: "2022, 2023"

SECTION E: DOCUMENT UPLOADS
----------------------------
21. Student Photo
    - Label: "Upload Photo"
    - Type: File input
    - Required: Yes
    - Accepted Formats: JPEG, JPG, PNG
    - Max File Size: 5MB
    - Validation:
      * File type check (MIME type)
      * File size check
      * Image dimensions check (optional: min 200x200px)
    - Processing: Convert to Base64 for MongoDB storage
    - Error Messages:
      * No file: "Photo is required"
      * Invalid type: "Only JPEG/PNG images allowed"
      * Too large: "Photo must be less than 5MB"
      * Corrupt file: "Unable to process image file"

22. Student Signature
    - Label: "Upload Signature"
    - Type: File input
    - Required: Yes
    - Accepted Formats: JPEG, JPG, PNG
    - Max File Size: 2MB
    - Validation: Same as photo
    - Processing: Convert to Base64
    - Error Messages:
      * No file: "Signature is required"
      * Invalid type: "Only JPEG/PNG images allowed"
      * Too large: "Signature must be less than 2MB"

FORM SUBMISSION:
----------------
Submit Button:
  - Label: "Submit Registration"
  - Validation: All required fields must be valid
  - Loading State: "Submitting..." with disabled button
  - Success: Redirect to status page with success message
  - Error: Display error banner with details

SECURITY MEASURES:
------------------
1. CSRF Protection: Token included in headers
2. Input Sanitization: All text inputs sanitized to prevent XSS
3. File Upload Security:
   - MIME type validation (not just extension)
   - File size limits enforced server-side
   - Base64 encoding prevents directory traversal
4. Rate Limiting: Max 3 submissions per hour per user
5. Duplicate Prevention: USN uniqueness checked before insert

CLIENT-SIDE VALIDATION:
-----------------------
- Real-time validation on blur (field loses focus)
- Red border + error message for invalid fields
- Submit button disabled until all fields valid
- Field-level error messages below each input

SERVER-SIDE VALIDATION:
-----------------------
- All client validations re-checked on server
- Database constraints enforced (unique, not null)
- Pydantic schema validation in FastAPI
- Return 400 Bad Request with detailed error JSON

ERROR RESPONSE FORMAT:
{
  "detail": "Validation error",
  "errors": [
    {
      "field": "usn",
      "message": "This USN is already registered"
    },
    {
      "field": "photo_base64",
      "message": "Photo must be less than 5MB"
    }
  ]
}


--------------------------------------------------------------------------------
FORM 2: ADMIN LOGIN FORM
--------------------------------------------------------------------------------

PURPOSE: Authenticate admin users with credentials

LOCATION: /login (LoginPage.jsx)
ACCESS: Public (unauthenticated users)
METHOD: POST /api/auth/login

FIELDS:
-------
1. Email Address
   - Label: "Email"
   - Type: Email input
   - Required: Yes
   - Placeholder: "admin@example.com"
   - Validation: Valid email format
   - Pattern: ^[a-zA-Z0-9._%+-]+@[a-zA-Z0-9.-]+\.[a-zA-Z]{2,}$
   - Error Messages:
     * Empty: "Email is required"
     * Invalid: "Please enter a valid email address"

2. Password
   - Label: "Password"
   - Type: Password input (masked)
   - Required: Yes
   - Min Length: 8 characters
   - Autocomplete: current-password
   - Error Messages:
     * Empty: "Password is required"
     * Too short: "Password must be at least 8 characters"

3. Remember Me (Optional)
   - Label: "Remember Me"
   - Type: Checkbox
   - Required: No
   - Effect: Extends JWT expiration to 7 days (vs default 24 hours)

Submit Button:
  - Label: "Sign In"
  - Loading State: "Signing in..."
  - Success: Store JWT token, redirect to /admin/dashboard
  - Error: Display error message ("Invalid credentials")

SECURITY MEASURES:
------------------
1. Password Security:
   - Never sent in plaintext (HTTPS required)
   - Server-side bcrypt comparison (hash never exposed)
   - Failed login attempts logged
2. Brute Force Protection:
   - Max 5 login attempts per IP per 15 minutes
   - Temporary account lockout after 10 failed attempts
3. JWT Security:
   - Signed with secret key (HS256 algorithm)
   - Includes expiration claim
   - Stored in httpOnly cookie OR localStorage (with XSS protection)
4. CSRF Protection: Token in headers for API calls

ERROR HANDLING:
---------------
- 401 Unauthorized: "Invalid email or password"
- 429 Too Many Requests: "Too many login attempts. Try again in 15 minutes"
- 500 Server Error: "Login service unavailable. Please try again later"


--------------------------------------------------------------------------------
FORM 3: EVENT CREATION FORM
--------------------------------------------------------------------------------

PURPOSE: Create new sports events

LOCATION: /admin/events (AdminEventsPage.jsx) - Modal form
ACCESS: Authenticated admins only
METHOD: POST /api/events

FIELDS:
-------
1. Event Name
   - Label: "Event Name"
   - Type: Text input
   - Required: Yes
   - Min Length: 3 characters
   - Max Length: 255 characters
   - Placeholder: "Inter-Department Cricket Tournament 2024"
   - Error Message: "Event name must be at least 3 characters"

2. Location/Venue
   - Label: "Location"
   - Type: Text input
   - Required: Yes
   - Max Length: 255 characters
   - Placeholder: "Main Stadium"
   - Error Message: "Location is required"

3. Start Date
   - Label: "Start Date"
   - Type: Date picker
   - Required: Yes
   - Validation: Today or future date only
   - Error Message: "Start date cannot be in the past"

4. End Date
   - Label: "End Date"
   - Type: Date picker
   - Required: Yes
   - Validation: Must be >= start_date
   - Error Message: "End date must be after or equal to start date"

5. Description
   - Label: "Description"
   - Type: Textarea
   - Required: No
   - Max Length: 1000 characters
   - Rows: 4
   - Placeholder: "Enter event details, rules, and requirements..."

Submit Button:
  - Label: "Create Event"
  - Loading: "Creating..."
  - Success: Close modal, refresh event list, show toast notification
  - Error: Display inline error

VALIDATION RULES:
-----------------
- Date Range: end_date >= start_date (enforced client + server)
- Future Dates: start_date >= today (recommended, not strict)
- Overlapping Events: Warning if same sport on same dates (optional)

SECURITY:
---------
- Requires valid admin JWT token
- created_by field auto-populated from token (user ID)
- SQL injection prevented (parameterized query)


--------------------------------------------------------------------------------
FORM 4: ATTENDANCE MARKING FORM
--------------------------------------------------------------------------------

PURPOSE: Mark daily attendance for event participants

LOCATION: /admin/attendance/:eventId (EventAttendancePage.jsx)
ACCESS: Authenticated admins only
METHOD: POST /api/attendance/mark

FIELDS:
-------
1. Event Selection
   - Label: "Select Event"
   - Type: Dropdown (autocomplete)
   - Required: Yes
   - Options: List of all events from database
   - Display: Event name + date range

2. Attendance Date
   - Label: "Date"
   - Type: Date picker
   - Required: Yes
   - Validation: Must be within event's start_date and end_date
   - Default: Today (if within range)
   - Error Message: "Attendance date must be within event date range"

3. Participant Attendance (Dynamic Table)
   - Columns:
     * USN (read-only)
     * Student Name (read-only, from denormalized field)
     * Status (radio buttons: Present / Absent / Not Marked)
   - Rows: Auto-populated from approved_participants table
   - Bulk Actions:
     * "Mark All Present" button
     * "Mark All Absent" button

Submit Button:
  - Label: "Save Attendance"
  - Loading: "Saving..."
  - Success: "Attendance marked for N students"
  - Error: Display error details

VALIDATION:
-----------
- Date within event range (server-side check)
- Duplicate prevention: UNIQUE(event_id, usn, attendance_date)
- At least 1 participant status must be set

SECURITY:
---------
- Requires admin authentication
- marked_by field auto-populated from JWT token
- Atomic transaction (all or nothing save)


--------------------------------------------------------------------------------
FORM 5: BULK EMAIL FORM
--------------------------------------------------------------------------------

PURPOSE: Send filtered bulk emails to students

LOCATION: /admin/email (AdminEmailPage.jsx)
ACCESS: Authenticated admins only
METHOD: POST /api/email/send-bulk

FIELDS:
-------
1. Email Subject
   - Label: "Subject"
   - Type: Text input
   - Required: Yes
   - Min Length: 3 characters
   - Max Length: 255 characters
   - Error Message: "Subject is required"

2. Email Body
   - Label: "Message"
   - Type: Rich textarea (supports HTML)
   - Required: Yes
   - Min Length: 10 characters
   - Placeholder Variables:
     * {{name}} - Student name
     * {{usn}} - Student USN
   - Newline Handling: Convert \n to <br> tags
   - Error Message: "Message body is required"

3. Filter: Branch (Optional)
   - Label: "Filter by Branch"
   - Type: Multi-select dropdown
   - Options: All branches (CSE, ISE, ECE, etc.)
   - Default: All branches selected

4. Filter: Semester (Optional)
   - Label: "Filter by Semester"
   - Type: Multi-select dropdown
   - Options: 1, 2, 3, 4, 5, 6, 7, 8
   - Default: All semesters selected

5. Filter: Specific USNs (Optional)
   - Label: "Specific USNs (comma-separated)"
   - Type: Textarea
   - Placeholder: "1RV21CS001, 1RV21EC023"
   - Processing: Split by comma, trim whitespace

6. Recipient Preview
   - Display: "This email will be sent to approximately N students"
   - Updates in real-time as filters change

Submit Button:
  - Label: "Send Email"
  - Confirmation: "Are you sure you want to send to N students?"
  - Loading: "Sending emails..."
  - Success: "Email sent to N students successfully"
  - Error: "Failed to send. See audit logs for details."

VALIDATION:
-----------
- At least 1 recipient must match filters
- Maximum recipients per send: 500 (configurable)
- Subject and body not empty
- Placeholder syntax valid

SECURITY:
---------
- Rate limiting: Max 10 bulk emails per hour per admin
- Audit logging: All sends logged in email_audit_logs
- Blockchain hash generated for audit integrity
- HTML sanitization (prevent malicious scripts)

EMAIL DELIVERY:
---------------
- Sent via SMTP (Gmail or configured server)
- Retry logic: 3 attempts per recipient
- Failure tracking: success_count and failure_count logged
- Async processing (doesn't block API response)


================================================================================
4. COMMON VALIDATION PATTERNS
================================================================================

PATTERN 1: EMAIL VALIDATION
----------------------------
Regex: ^[a-zA-Z0-9._%+-]+@[a-zA-Z0-9.-]+\.[a-zA-Z]{2,}$
Library: HTML5 type="email" OR custom regex
Example: john.doe@rvce.edu.in ✓
Example: invalid@.com ✗

PATTERN 2: PHONE VALIDATION (INDIAN)
-------------------------------------
Regex: ^[6-9][0-9]{9}$
Explanation: Starts with 6-9, followed by 9 digits
Example: 9876543210 ✓
Example: 1234567890 ✗ (starts with 1)

PATTERN 3: USN VALIDATION (RVCE Format)
----------------------------------------
Regex: ^1RV[0-9]{2}[A-Z]{2}[0-9]{3}$
Explanation:
  - 1RV: Prefix
  - [0-9]{2}: Year (e.g., 21, 22)
  - [A-Z]{2}: Branch code (CS, EC, etc.)
  - [0-9]{3}: Roll number (001-999)
Example: 1RV21CS045 ✓
Example: 1rv21cs045 ✗ (lowercase)

PATTERN 4: NAME VALIDATION
--------------------------
Regex: ^[A-Za-z\s\.]+$
Allows: Letters, spaces, periods
Example: John Doe ✓
Example: John123 ✗ (numbers)

PATTERN 5: DATE VALIDATION
--------------------------
Format: YYYY-MM-DD (ISO 8601)
Library: HTML5 type="date" OR moment.js/date-fns
Range checks: Custom logic for min/max dates


================================================================================
5. ERROR HANDLING STRATEGY
================================================================================

FRONTEND ERROR DISPLAY:
-----------------------
1. Field-Level Errors
   - Display below the field
   - Red border around invalid input
   - Icon indicator (exclamation mark)

2. Form-Level Errors
   - Banner at top of form
   - List all errors (max 5 visible, "show more" link)
   - Scroll to first error field

3. Toast Notifications
   - Success: Green toast, 3-second auto-dismiss
   - Error: Red toast, manual dismiss
   - Warning: Yellow toast, 5-second auto-dismiss

BACKEND ERROR RESPONSES:
------------------------
400 Bad Request: Validation errors
{
  "detail": "Validation failed",
  "errors": [
    {"field": "usn", "message": "Already exists"},
    {"field": "dob", "message": "Invalid date"}
  ]
}

401 Unauthorized: Authentication failed
{
  "detail": "Invalid credentials"
}

403 Forbidden: Insufficient permissions
{
  "detail": "Admin access required"
}

404 Not Found: Resource doesn't exist
{
  "detail": "Event not found"
}

429 Too Many Requests: Rate limit exceeded
{
  "detail": "Too many requests. Try again in 15 minutes"
}

500 Internal Server Error: Unexpected failure
{
  "detail": "An unexpected error occurred. Please try again."
}


================================================================================
6. ACCESSIBILITY (WCAG 2.1 COMPLIANCE)
================================================================================

FORM ACCESSIBILITY FEATURES:
----------------------------
1. Labels: All inputs have associated <label> tags
2. ARIA Attributes:
   - aria-required="true" for required fields
   - aria-invalid="true" for validation errors
   - aria-describedby for error messages
3. Keyboard Navigation:
   - Tab order logical (top to bottom)
   - Enter submits form
   - Escape closes modals
4. Color Contrast: Error messages meet AA standard (4.5:1)
5. Screen Reader Support:
   - Error announcements via aria-live regions
   - Field hints via aria-describedby

================================================================================
7. PERFORMANCE OPTIMIZATIONS
================================================================================

1. DEBOUNCED VALIDATION:
   - Real-time validation debounced by 500ms
   - Prevents excessive server calls

2. LAZY FILE UPLOAD:
   - Files uploaded on form submit (not on selection)
   - Progress bar for large file uploads

3. AUTOCOMPLETE:
   - Event selection uses autocomplete (virtualized list)
   - Branch/semester dropdowns cached client-side

4. FORM PERSISTENCE:
   - Draft saved to localStorage every 30 seconds
   - Restored on page reload ("Continue where you left off")

================================================================================
END OF FORMS DESIGN, SECURITY & VALIDATION DOCUMENTATION
================================================================================
